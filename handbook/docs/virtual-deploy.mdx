---
id: virtual-deploy
title: 34.4 二级虚拟目录部署
sidebar_label: 34.4 二级虚拟目录部署
---

## 34.4.1 关于二级虚拟目录

通常我们的站点都是部署在网站的根目录下的，但是有些时候，我们可能将网站根目录下的目录作为二级站点或子站点，这个时候，就会出现 `404` 错误了。

这个时候就需要进行一些特殊配置了。

### 34.4.1.1 配置 `AppSettings`

我们只需要配置 `AppSettings` 即可：

```json
{
  "AppSettings": {
    "VirtualPath": "/虚拟目录"
  }
}
```

### 34.4.2 `.NET6 WebApplication 模式下虚拟目录配置`

:::important 版本说明

以下内容仅限 `Furion 3.1.2 +` 版本使用。

:::

由于在 `.NET6` 的 `WebApplication` 模式下微软底层发生了改变，**所以需要使用 `app.UseVirtualPath()` 包裹 `app.UseInject()` 和 `app.MapRouteControllers()`**：

```cs {1,4}
app.UseVirtualPath(app =>
{
    app.UseInject(String.Empty);  // 注意 String.Empty 只是例子，可以不填或填其他的，见一分钟入门
    app.MapRouteControllers();
});
```

**注意，`app.MapRouteControllers()` 是替换 `app.MapControllers()` 的！

## 34.4.3 反馈与建议

:::note 与我们交流

给 Furion 提 [Issue](https://gitee.com/dotnetchina/Furion/issues/new?issue)。

:::
